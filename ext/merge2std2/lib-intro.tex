%!TEX root = std.tex
\rSec0[std2.library]{Library introduction}

\rSec1[std2.library.general]{General}

\pnum
This Clause describes the contents of the
\changed{\term{Ranges library}}{\term{Standard Library, Version 2}},
\indextext{library!Std2}%
how a well-formed \Cpp program makes use of the library, and
how a conforming implementation may provide the entities in the library.

\pnum
\changed{Clause}{Section}~\ref{std2.requirements}\changed{,}{ and} \changed{C}{Subc}lauses~\ref{\firstlibchapter}
through~\ref{\lastlibchapter}\removed{, and Annex~\ref{std2.depr}} specify the contents of the
library, as well as library requirements and constraints on both well-formed
\Cpp programs and conforming implementations.

\pnum
Detailed specifications for each of the components in the library are in
\changed{C}{Subc}lauses~\ref{\firstlibchapter}--\ref{\lastlibchapter}, as shown in
Table~\ref{tab:library.categories}.

\begin{libsumtabbase}{Library categories}{tab:library.categories}{Clause}{Category}
\removed{\ref{concepts.lib}} &   &   \removed{Concepts library}  \\
\ref{std2.utilities}         &   &   General utilities library   \\
\ref{std2.iterators}         &   &   Iterators library           \\
\ref{std2.ranges}            &   &   Ranges library              \\
\ref{std2.algorithms}        &   &   Algorithms library          \\
\ref{std2.numerics}          &   &   Numerics library            \\
\end{libsumtabbase}

\pnum
\removed{The concepts library (Clause~\ref{concepts.lib}) describes library components
that \Cpp programs may use to perform compile-time validation of template
parameters and perform function dispatch based on properties of types.}

\pnum
The general utilities library (\changed{C}{Subc}lause~\ref{std2.utilities}) includes components used
by other library elements and components used as infrastructure in \Cpp
programs, such as function objects.

\pnum
The iterators library (\changed{C}{Subc}lause~\ref{std2.iterators}) describes components that \Cpp
programs may use to perform iterations over containers (Clause~\cxxref{containers}),
streams~(\cxxref{iostream.format}), stream buffers~(\cxxref{stream.buffers}),
and ranges~(\ref{std2.ranges}).

\pnum
The ranges library (\changed{C}{Subc}lause~\ref{std2.ranges}) describes components for dealing with
ranges of elements.

\pnum
The algorithms library (\changed{C}{Subc}lause~\ref{std2.algorithms}) describes components that \Cpp
programs may use to perform algorithmic operations on containers
(Clause~\cxxref{containers}) and other sequences.

\pnum
The numerics library (\changed{C}{Subc}lause~\ref{std2.numerics}) provides concepts that are useful
to constrain numeric algorithms.

\rSec1[std2.description]{Method of description (Informative)}

\pnum
This subclause describes the conventions used to specify the \changed{Ranges
library}{Standard Library, Version 2}. \ref{std2.structure} describes the structure of the normative
\changed{C}{Subc}lauses~\ref{\firstlibchapter} through~\ref{\lastlibchapter}\removed{ and
Annex~\ref{std2.depr}}. \ref{std2.conventions} describes other editorial conventions.

\rSec2[std2.structure]{Structure of each clause}

\rSec3[std2.structure.elements]{Elements}

\pnum
Each library \changed{c}{subc}lause contains the following elements, as applicable:\footnote{To
save space, items that do not apply to a \changed{C}{Subc}lause are omitted.
For example, if a \changed{C}{Subc}lause does not specify any requirements,
there will be no ``Requirements'' \changed{subclause}{section}.}

\begin{itemize}
\item Summary
\item Requirements
\item Detailed specifications
\end{itemize}

\rSec3[std2.structure.summary]{Summary}

\pnum
The Summary provides a synopsis of the category, and introduces the first-level \changed{subclauses}{sections}.
Each \changed{subclause}{section} also provides a summary, listing the headers specified in the
\changed{subclause}{section} and the library entities provided in each header.

\pnum
Paragraphs labeled ``Note(s):'' or ``Example(s):'' are informative, other paragraphs
are normative.

\pnum
The contents of the summary and the detailed specifications include:

\begin{itemize}
\item macros
\item values
\item types
\item classes and class templates
\item functions and function templates
\item objects
\item concepts
\end{itemize}

\rSec3[std2.structure.requirements]{Requirements}

\pnum
\indextext{requirements}%
Requirements describe constraints that shall be met by a \Cpp program that
extends the \changed{Ranges library}{Standard Library, Version 2}.
Such extensions are generally one of the following:

\begin{itemize}
\item Template arguments
\item Derived classes
\item Containers, iterators, and algorithms that meet an interface convention
or satisfy a concept
\end{itemize}

\pnum
Interface convention requirements are stated as generally as possible. Instead
of stating ``class X has to define a member function \tcode{operator++()},'' the
interface requires ``for any object \tcode{x} of class \tcode{X}, \tcode{++x} is
defined.'' That is, whether the operator is a member is unspecified.

\pnum
Requirements are stated in terms of concepts~(\changed{Concepts TS [dcl.spec.concept]}{\cxxref{temp}}).
Concepts are stated in terms of well-defined expressions that define valid terms of
the types that satisfy the concept. For every set of
well-defined expression requirements there is a named concept that
specifies an initial set of the valid expressions and their semantics. Any generic
algorithm (\changed{C}{Subc}lause~\ref{std2.algorithms}) that uses the well-defined expression requirements
is described in terms of the valid expressions for its formal type parameters.

\pnum
Template argument requirements are sometimes referenced by name.
See~\cxxref{type.descriptions}.

\pnum
In some cases the semantic requirements are presented as \Cpp code.
Such code is intended as a
specification of equivalence of a construct to another construct, not
necessarily as the way the construct
must be implemented.\footnote{Although in some cases the code given is
unambiguously the optimum implementation.}

\pnum
Required operations of any concept defined in this document need not be
total functions; that is, some arguments to a required operation may
result in the required semantics failing to be satisfied. \enterexample
The required \tcode{<} operator of the \tcode{StrictTotallyOrdered}
concept~(\ref{concepts.lib.compare.stricttotallyordered}) does not meet the
semantic requirements of that concept when operating on NaNs.\exitexample
This does not affect whether a type satisfies the concept.

\pnum
A declaration may explicitly impose requirements through its associated
constraints~(\removed{Concepts TS} [temp.\brk{}constr.\brk{}decl]). When the associated constraints
refer to a concept~(\removed{Concepts TS} [\changed{dcl.spec}{temp}.concept]), additional semantic requirements are
imposed on the use of the declaration.

\rSec3[std2.structure.specifications]{Detailed specifications}

\pnum
The detailed specifications of each entity defined in
Clauses~\ref{\firstlibchapter}--\ref{\lastlibchapter} follow the conventions
established by \cxxref{structure.specifications}.

\rSec2[std2.conventions]{Other conventions}
\indextext{conventions}%

\pnum
This subclause describes several editorial conventions used to describe the contents
of the \changed{Ranges library}{Standard Library, Version 2}. These conventions are for describing
member functions~(\ref{std2.functions.within.classes}),
and private members~(\ref{std2.objects.within.classes}).

\rSec3[std2.functions.within.classes]{Functions within classes}

\pnum
This \changed{document}{Clause} follows the same conventions as specified in \cxxref{functions.within.classes}.

\rSec3[std2.objects.within.classes]{Private members}

\pnum
This \changed{document}{Clause} follows the same conventions as specified in \cxxref{objects.within.classes}.

\rSec1[std2.requirements]{Library-wide requirements}

\pnum
This subclause specifies requirements that apply to the entire \changed{Ranges library}{Standard Library, Version 2}.
\changed{C}{Subc}lauses~\ref{\firstlibchapter} through~\ref{\lastlibchapter}\removed{ and Annex~\ref{std2.depr}}
specify the requirements of individual entities within the library.

\pnum
Requirements specified in terms of interactions between threads do not apply to
programs having only a single thread of execution.

\pnum
Within this subclause, \ref{std2.organization} describes the library's contents and
organization, \ref{std2.using} describes how well-formed \Cpp programs gain access to
library entities, \ref{std2.constraints} describes constraints on well-formed \Cpp
programs, and \ref{std2.conforming} describes constraints on conforming
implementations.

\rSec2[std2.organization]{Library contents and organization}

\pnum
\ref{std2.contents} describes the entities and macros defined in the \changed{Ranges library}{Standard Library, Version 2}.

\rSec3[std2.contents]{Library contents}

\pnum
The \changed{Ranges library}{Standard Library, Version 2} provides definitions for the entities and macros specified in
the \changed{Ranges library}{Standard Library, Version 2} headers~(\ref{std2.headers}).

\pnum
All library entities are defined within an inline namespace \tcode{v1} within
the namespace \changed{\tcode{std::\brk{}experimental::\brk{}ranges}}{\tcode{::std2}} or namespaces nested within
namespace \changed{\tcode{std::experimental::ranges::v1}}{\tcode{::std2::v1}}.
\indextext{namespace}
It is unspecified whether names declared in a specific namespace are declared
directly in that namespace or in an inline namespace inside that namespace.

\rSec2[std2.headers]{Headers}

\pnum
Each element of the \changed{Ranges library}{Standard Library, Version 2} is declared or defined (as appropriate) in a
header.

\pnum
The \changed{Ranges library}{Standard Library, Version 2} provides the \changed{Ranges library}{Standard Library, Version 2} headers, shown in Table~\ref{tab:headers}.

\begin{floattable}{\changed{Ranges TS library}{Standard Library, Version 2} headers}{tab:headers}
{ll}
\topline
\tcode{<\changed{experimental/ranges}{std2}/algorithm>}  & \tcode{<\changed{experimental/ranges}{std2}/range>}       \\
\tcode{\removed{<experimental/ranges/concepts>}}   & \tcode{<\changed{experimental/ranges}{std2}/tuple>}       \\
\tcode{<\changed{experimental/ranges}{std2}/functional>} & \tcode{\removed{<experimental/ranges/type_traits>}} \\
\tcode{<\changed{experimental/ranges}{std2}/iterator>}   & \tcode{<\changed{experimental/ranges}{std2}/utility>}     \\
\tcode{<\changed{experimental/ranges}{std2}/random>} & \\
\bottomline
\end{floattable}

\rSec2[std2.using]{Using the library}

\rSec3[std2.using.overview]{Overview}

\pnum
This section describes how a \Cpp program gains access to the facilities of the
\changed{Ranges library}{Standard Library, Version 2}. \ref{std2.using.headers} describes effects during translation
phase 4, while~\ref{std2.using.linkage} describes effects during phase
8~(\cxxref{lex.phases}).

\rSec3[std2.using.headers]{Headers}

The entities in the \changed{Ranges library}{Standard Library, Version 2} are defined in headers, the use of which is
governed by the same requirements as specified in \cxxref{using.headers}.

\rSec3[std2.using.linkage]{Linkage}

\pnum
Entities in the \Cpp standard library have external
linkage~(\cxxref{basic.link}). Unless otherwise specified, objects and functions
have the default \tcode{extern "C++"} linkage~(\cxxref{dcl.link}).

\rSec2[std2.constraints]{Constraints on programs}

\rSec3[std2.constraints.overview]{Overview}

\pnum
This section describes restrictions on \Cpp programs that use the facilities of
the \changed{Ranges library}{Standard Library, Version 2}. The following subclauses specify constraints on the
program's use of \changed{Ranges library}{Standard Library, Version 2} classes as base classes~(\ref{std2.derived.classes})
and other constraints.

\rSec3[std2.derived.classes]{Derived classes}

\pnum
Virtual member function signatures defined
\indextext{function!virtual member}%
for a base class in the \removed{Ranges}
\indextext{class!base}%
\indextext{library!Std2}%
\changed{library}{Standard Library, Version 2} may be overridden in a derived class defined in the
program~(\cxxref{class.virtual}).

\rSec3[std2.res.on.functions]{Other functions}

\pnum
In certain cases (operations on types used to instantiate \changed{Ranges library}{Standard Library, Version 2}
template components), the \changed{Ranges library}{Standard Library, Version 2} depends on components supplied by a
\Cpp program. If these components do not meet their requirements, this document
places no requirements on the implementation.

\pnum
In particular, the effects are undefined if an incomplete
type~(\cxxref{basic.types}) is used as a template argument when instantiating a
template component or evaluating a concept, unless specifically allowed for that
component.

\rSec3[std2.res.on.arguments]{Function arguments}

\pnum
\indextext{restriction}%
\indextext{argument}%
The constraints on arguments passed to \Cpp standard library function as
specified in \cxxref{res.on.arguments} also apply to arguments passed to
functions in the \changed{Ranges library}{Standard Library, Version 2}.

\rSec3[std2.res.on.objects]{Library object access}

\pnum
The constraints on object access by \Cpp standard library functions as specified
in \cxxref{res.on.objects} also apply to object access by functions in the
\changed{Ranges library}{Standard Library, Version 2}.

\rSec3[std2.res.on.required]{Requires paragraph}

\pnum
\indextext{restriction}%
Violation of the preconditions specified in a function's \requires paragraph
results in undefined behavior unless the function's \throws paragraph specifies
throwing an exception when the precondition is violated.

\rSec3[std2.res.on.requirements]{Semantic requirements}

\pnum
If the semantic requirements of a declaration's
constraints~(\ref{std2.structure.requirements}) are not satisfied at the point of
use, the program is ill-formed, no diagnostic required.

\rSec2[std2.conforming]{Conforming implementations}

\pnum
The constraints upon, and latitude of, implementations of the \changed{Ranges library}{Standard Library, Version 2}
follow the same constraints and latitudes for implementations of the \Cpp
standard library as specified in \cxxref{conforming}.

\ednote{Remove section [customization.point.object] ``Customization Point Objects''. They
are introduced by P0898.}
